<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!-- Country Group Form View Inheritance -->
    <record id="view_country_group_form_inherit" model="ir.ui.view">
        <field name="name">res.country.group.form.inherit</field>
        <field name="model">res.country.group</field>
        <field name="inherit_id" ref="base.view_country_group_form"/>
        <field name="arch" type="xml">
            <!-- Add stat button -->
            <xpath expr="//div[@class='oe_title']" position="before">
                <div class="oe_button_box" name="button_box">
                    <button name="%(action_country_group_analytic_distribution)d"
                            type="action"
                            class="oe_stat_button"
                            icon="fa-line-chart"
                            invisible="not id"
                            context="{'default_country_group_id': id}">
                        <field name="analytic_distribution_count" widget="statinfo"
                               string="Distributions"/>
                    </button>
                </div>
            </xpath>

            <!-- Add One2many field -->
            <xpath expr="//field[@name='country_ids']" position="after">
                <field name="analytic_distribution_ids"
                       context="{'default_country_group_id': id}"
                       groups="analytic.group_analytic_accounting">
                    <list>
                        <field name="company_id" groups="base.group_multi_company"/>
                        <field name="analytic_distribution" widget="analytic_distribution"/>
                    </list>
                </field>
            </xpath>
        </field>
    </record>
</odoo>
